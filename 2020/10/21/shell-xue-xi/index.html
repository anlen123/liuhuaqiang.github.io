<!DOCTYPE HTML>
<html lang="zh-CN">


<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta name="keywords" content="Shell学习, 未闻丶死讯的博客">
    <meta name="description" content="菜鸡博客，大佬勿喷">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>Shell学习 | 未闻丶死讯的博客</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<link rel="alternate" href="/atom.xml" title="未闻丶死讯的博客" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">未闻丶死讯的博客</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">未闻丶死讯的博客</div>
        <div class="logo-desc">
            
            菜鸡博客，大佬勿喷
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/anlen123" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/anlen123" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/14.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Shell学习</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        height: calc(100vh - 250px);
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    .toc-fixed .toc-link::before{
        position: fixed!important;/*当toc的位置改为fixed时，.toc-link::before也要改为fixed*/
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/linux/">
                                <span class="chip bg-color">linux</span>
                            </a>
                        
                            <a href="/tags/shell/">
                                <span class="chip bg-color">shell</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2020-10-21
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="shell学习"><a href="#shell学习" class="headerlink" title="shell学习"></a>shell学习</h1><h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><pre class=" language-shell"><code class="language-shell">切换su 

不加- 如 su lhq  nologshell

加- 如  su - lhq loginshell



read ip 是输入

位置变量

$1 是后面跟的第一个变量

设置环境变量的关键字 export (作用范围是全局)</code></pre>
<h1 id="预变量"><a href="#预变量" class="headerlink" title="预变量"></a>预变量</h1><table>
<thead>
<tr>
<th align="left">参数处理</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">$#</td>
<td align="left">传递到脚本的参数个数</td>
</tr>
<tr>
<td align="left">$*</td>
<td align="left">以一个单字符串显示所有向脚本传递的参数。 如”$*”用「”」括起来的情况、以”$1 $2 … $n”的形式输出所有参数。</td>
</tr>
<tr>
<td align="left">$$</td>
<td align="left">脚本运行的当前进程ID号</td>
</tr>
<tr>
<td align="left">$!</td>
<td align="left">后台运行的最后一个进程的ID号</td>
</tr>
<tr>
<td align="left">$@</td>
<td align="left">与$*相同，但是使用时加引号，并在引号中返回每个参数。 如”$@”用「”」括起来的情况、以”$1” “$2” … “$n” 的形式输出所有参数。</td>
</tr>
<tr>
<td align="left">$-</td>
<td align="left">显示Shell使用的当前选项，与<a href="https://www.runoob.com/linux/linux-comm-set.html" target="_blank" rel="noopener">set命令</a>功能相同。</td>
</tr>
<tr>
<td align="left">$?</td>
<td align="left">显示最后命令的退出状态。0表示没有错误，其他任何值表明有错误。</td>
</tr>
</tbody></table>
<pre class=" language-shell"><code class="language-shell">ping 一个txt 里面的ip
#!/usr/bin/bash 
if [ $# -eq 0 ]; then
    echo "`basename $0` no file!"
    exit
fi

if [ ! -f $1 ]; then 
    echo "not file!!"
    exit
fi 

for ip in `cat $1`
do 
    ping -c1 $ip &>/dev/null 
    if [ $? -eq 0 ];then
        echo -e " $ip true"
    else
        echo -e " $ip false"
    fi
done</code></pre>
<h1 id="运算"><a href="#运算" class="headerlink" title="运算"></a>运算</h1><pre class=" language-shell"><code class="language-shell">1.expr 1 + 1
2.echo $((1+1))
3.echo $[1+1]</code></pre>
<h1 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h1><pre class=" language-shell"><code class="language-shell">bash -vx xx.sh

sh -n xx.sh  仅调试syntax error
sh -vx xx.sh 以调试的方式执行,并且,查询整个执行过程</code></pre>
<h1 id="切片"><a href="#切片" class="headerlink" title="切片"></a>切片</h1><pre class=" language-shell"><code class="language-shell">{14:11}~/sh ? url=www.baidu.com.cn
{14:12}~/sh ? echo ${#url} //长度
16
{14:12}~/sh ? echo ${url#www} //从前往后
.baidu.com.cn
{14:12}~/sh ? echo ${url#www*} 
.baidu.com.cn
{14:13}~/sh ? echo ${url#*.} 非贪婪
baidu.com.cn
{14:13}~/sh ? echo ${url##*.} 贪婪
cn
{14:13}~/sh ? echo ${url%com}  %从后往前
www.baidu.com.cn
{14:13}~/sh ? echo ${url%.com}
www.baidu.com.cn
{14:13}~/sh ? echo ${url%cn}
www.baidu.com.
{14:14}~/sh ? echo ${url%.cn}
www.baidu.com
{14:14}~/sh ? echo ${url%.*}
www.baidu.com
{14:14}~/sh ? echo ${url%%.*}
www
{14:14}~/sh ? </code></pre>
<pre class=" language-shell"><code class="language-shell">字符串切片
{14:17}~/sh ? url=www.baidu.com.cn
{14:17}~/sh ? echo ${url:2:5}
w.bai
{14:18}~/sh ? echo ${url:5:5}
aidu.
{14:18}~/sh ? echo ${url:5}
aidu.com.cn
{14:18}~/sh ? </code></pre>
<pre class=" language-shell"><code class="language-shell">替换

{14:19}~/sh ? url=www.baidu.com.cn
{14:20}~/sh ? echo ${url/baidu/google}
www.google.com.cn
{14:20}~/sh ? echo ${url/c/C}
www.baidu.Com.cn
{14:20}~/sh ? echo ${url//c/C}
www.baidu.Com.Cn
{14:20}~/sh ? </code></pre>
<pre class=" language-shell"><code class="language-shell">{14:22}~/sh ? var1    
zsh: command not found: var1
{14:23}~/sh ? var2=
{14:23}~/sh ? var3=233
{14:23}~/sh ? echo ${var1-123}
123
{14:23}~/sh ? echo ${var2-123}

{14:23}~/sh ? echo ${var3-123}
233</code></pre>
<pre class=" language-shell"><code class="language-shell">shell 中的${}，##, %% , ：- ，：+， ？ 的使用
假设我们定义了一个变量为：
file=/dir1/dir2/dir3/my.file.txt

可以用${ }分别替换得到不同的值：
${file#*/}：删掉第一个/ 及其左边的字符串：dir1/dir2/dir3/my.file.txt
${file##*/}：删掉最后一个/  及其左边的字符串：my.file.txt
${file#*.}：删掉第一个.  及其左边的字符串：file.txt
${file##*.}：删掉最后一个.  及其左边的字符串：txt
${file%/*}：删掉最后一个 /  及其右边的字符串：/dir1/dir2/dir3
${file%%/*}：删掉第一个/  及其右边的字符串：(空值)
${file%.*}：删掉最后一个 .  及其右边的字符串：/dir1/dir2/dir3/my.file
${file%%.*}：删掉第一个 .   及其右边的字符串：/dir1/dir2/dir3/my

记忆的方法为：
# 是 去掉左边（键盘上#在 $ 的左边）
%是去掉右边（键盘上% 在$ 的右边）
单一符号是最小匹配；两个符号是最大匹配
${file:0:5}：提取最左边的5 个字节：/dir1
${file:5:5}：提取第5 个字节右边的连续5个字节：/dir2

也可以对变量值里的字符串作替换：
${file/dir/path}：将第一个dir 替换为path：/path1/dir2/dir3/my.file.txt
${file//dir/path}：将全部dir 替换为path：/path1/path2/path3/my.file.txt

利用${ } 还可针对不同的变数状态赋值(沒设定、空值、非空值)： 
${file-my.file.txt} ：假如$file 沒有设定，則使用my.file.txt 作传回值。(空值及非空值時不作处理) 
${file:-my.file.txt} ：假如$file 沒有設定或為空值，則使用my.file.txt 作傳回值。(非空值時不作处理)
${file+my.file.txt} ：假如$file 設為空值或非空值，均使用my.file.txt 作傳回值。(沒設定時不作处理)
${file:+my.file.txt} ：若$file 為非空值，則使用my.file.txt 作傳回值。(沒設定及空值時不作处理)
${file=my.file.txt} ：若$file 沒設定，則使用my.file.txt 作傳回值，同時將$file 賦值為my.file.txt 。(空值及非空值時不作处理)
${file:=my.file.txt} ：若$file 沒設定或為空值，則使用my.file.txt 作傳回值，同時將$file 賦值為my.file.txt 。(非空值時不作处理)
${file?my.file.txt} ：若$file 沒設定，則將my.file.txt 輸出至STDERR。(空值及非空值時不作处理)


${file:?my.file.txt} ：若$file 没设定或为空值，则将my.file.txt 输出至STDERR。(非空值時不作处理)

${#var} 可计算出变量值的长度：


${#file} 可得到27 ，因为/dir1/dir2/dir3/my.file.txt 是27个字节

我们只需要努力，然后剩下的交给时间。
分类: shell
</code></pre>
<h1 id="shell-中的参数"><a href="#shell-中的参数" class="headerlink" title="shell [    ] 中的参数"></a>shell [    ] 中的参数</h1><pre class=" language-shell"><code class="language-shell">if [ str1 = str2 ]　　　　　  当两个串有相同内容、长度时为真 
if [ str1 != str2 ]　　　　　 当串str1和str2不等时为真 
if [ -n str1 ]　　　　　　    当串的长度大于0时为真(串非空) 
if [ -z str1 ]　　　　　　　 当串的长度为0时为真(空串) 
if [ str1 ]　　　　　　　　 当串str1为非空时为真
       -eq: 测试两个整数是否相等；比如 $A -eq $B
       -ne: 测试两个整数是否不等；不等，为真；相等，为假；
       -gt: 测试一个数是否大于另一个数；大于，为真；否则，为假；
       -lt: 测试一个数是否小于另一个数；小于，为真；否则，为假；
       -ge: 大于或等于
       -le：小于或等于 
if [-d $1]
     这个的意思是 从外面传一个参数给$1 -d是判断$!这个目录存不存在
     所以你要穿的参数如果是正确的文件目录名,则此时的判断值为0 即真
[ -f 判断参数 ] 判断一个普通文件是不是存在
[ -s 文件名 ] 文件存在且内容非空 即必须要一个空格以上的字符
[ -e 文件目录 ] 文件目录下是否不为空
[-z 字符串] 在if里的意思是 空 ,字符串长度为0，返回真


用man test可以查看文档</code></pre>
<h1 id="小总结"><a href="#小总结" class="headerlink" title="小总结"></a>小总结</h1><pre class=" language-shell"><code class="language-shell">() 子shell
(()) 数值比较,运算,c语言
$() 命令替换  $(cmd)
$(()) 整数运算

{} 集合
${} 
[] 比较 用于if 
[[]]  正则比较 [[ =~ ]] 
$[] 运算</code></pre>
<h1 id="shell并发"><a href="#shell并发" class="headerlink" title="shell并发"></a>shell并发</h1><pre class=" language-shell"><code class="language-shell">打开一个文件
exec 6<> /file
{11:43}~ ➭ ll /proc/$$/fd
total 0
lrwx------ 1 root root 64 Jul 10 11:07 0 -> /dev/pts/0
lrwx------ 1 root root 64 Jul 10 11:07 1 -> /dev/pts/0
lrwx------ 1 root root 64 Jul 10 11:07 10 -> /dev/pts/0
lrwx------ 1 root root 64 Jul 10 11:07 2 -> /dev/pts/0
lrwx------ 1 root root 64 Jul 10 11:07 6 -> /root/file1
{11:44}~ ➭ echo "123" >> /proc/$$/fd/6
{11:44}~ ➭ cat file1
123
{11:44}~ ➭ 
{11:44}~ ➭ rm -rf file1
{11:44}~ ➭ ll /proc/$$/fd           
total 0
lrwx------ 1 root root 64 Jul 10 11:07 0 -> /dev/pts/0
lrwx------ 1 root root 64 Jul 10 11:07 1 -> /dev/pts/0
lrwx------ 1 root root 64 Jul 10 11:07 10 -> /dev/pts/0
lrwx------ 1 root root 64 Jul 10 11:07 2 -> /dev/pts/0
lrwx------ 1 root root 64 Jul 10 11:07 6 -> /root/file1 (deleted)
{11:44}~ ➭ cp /proc/$$/fd/6 ~

关闭文件
{11:46}~ ➭ exec 6<&-
{11:46}~ ➭ ll /proc/$$/fd
total 0
lrwx------ 1 root root 64 Jul 10 11:07 0 -> /dev/pts/0
lrwx------ 1 root root 64 Jul 10 11:07 1 -> /dev/pts/0
lrwx------ 1 root root 64 Jul 10 11:07 10 -> /dev/pts/0
lrwx------ 1 root root 64 Jul 10 11:07 2 -> /dev/pts/0</code></pre>
<h1 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h1><pre class=" language-shell"><code class="language-shell">#!/usr/bin/bash

a=(1 2 3 4 5)
echo ${a[2]} 
echo ${a[@]} #查看全部数组元素
echo ${!a[@]} #查看全部数组的下标


declare -A b #定义关联数组(字典) 的定义
b=([age]=22 [name]=华强)

echo ${b[age]}
echo ${b[@]}
echo ${!b[@]}
</code></pre>
<h1 id="expect"><a href="#expect" class="headerlink" title="expect"></a>expect</h1><pre class=" language-shell"><code class="language-shell">#!/usr/bin/expect

set ip [lindex $argv 0]
set user [lindex $argv 1]
set password LHQlhq1761512493
set timeout 5


spawn ssh $user@$ip

expect {
    "yes/no" { send "yes\r"; exp_continue }
    "password:" { send "$password\r" };
}

interact
</code></pre>
<h1 id="scp"><a href="#scp" class="headerlink" title="scp"></a>scp</h1><pre class=" language-shell"><code class="language-shell">#!/usr/bin/bash
file=$1
#ip=$2
pass=LHQlhq1761512493

cat <<-EOF
+---------------------------+
|   1.阿里云轻量级服务器    |
|   2.送的半年的阿里云ESC   |
+---------------------------+
EOF
echo -en "你要进入哪个服务器："
read num
if [ $num -eq 1 ];then
    ip=123.56.145.243
elif [ $num -eq 2 ];then
    ip=47.94.82.228
else
    echo "error!!"
    exit
fi

scp -r $1 ssh $ip:~
</code></pre>
<h1 id="函数定义"><a href="#函数定义" class="headerlink" title="函数定义"></a>函数定义</h1><pre class=" language-shell"><code class="language-shell">#!/usr/bin/bash

function jx(){
    sum=1
    for((i=1;i<=$1;i++))
    do
        sum=$[$sum*$i]
    done
    echo $sum
    return $num
}

ans=`jx $1`
echo $ans</code></pre>
<h1 id="管道多线程并发"><a href="#管道多线程并发" class="headerlink" title="管道多线程并发"></a>管道多线程并发</h1><pre class=" language-shell"><code class="language-shell">#!/usr/bin/bash 

thread=5
fifo_name=/tmp/$$.fifo

# 创建一个命名管道
mkfifo $fifo_name

# 打开文件描述符
exec 8<> $fifo_name

# 删除管道文件(但是描述没有释放)
rm $fifo_name

for i in `seq $thread`
do 
    echo >&8
done



for i in `seq 100`
do
    read -u 8
    {
    echo "$i"
    echo >&8
    }&

done

wait

# 关闭文件描述符
exec 8>&-

echo "finish"
</code></pre>
<h1 id="正则"><a href="#正则" class="headerlink" title="正则"></a>正则</h1><h2 id="普通字符"><a href="#普通字符" class="headerlink" title="普通字符"></a>普通字符</h2><p>普通字符包括没有显式指定为元字符的所有可打印和不可打印字符。这包括所有大写和小写字母、所有数字、所有标点符号和一些其他符号。</p>
<hr>
<h2 id="非打印字符"><a href="#非打印字符" class="headerlink" title="非打印字符"></a>非打印字符</h2><p>非打印字符也可以是正则表达式的组成部分。下表列出了表示非打印字符的转义序列：</p>
<table>
<thead>
<tr>
<th align="left">字符</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">\cx</td>
<td align="left">匹配由x指明的控制字符。例如， \cM 匹配一个 Control-M 或回车符。x 的值必须为 A-Z 或 a-z 之一。否则，将 c 视为一个原义的 ‘c’ 字符。</td>
</tr>
<tr>
<td align="left">\f</td>
<td align="left">匹配一个换页符。等价于 \x0c 和 \cL。</td>
</tr>
<tr>
<td align="left">\n</td>
<td align="left">匹配一个换行符。等价于 \x0a 和 \cJ。</td>
</tr>
<tr>
<td align="left">\r</td>
<td align="left">匹配一个回车符。等价于 \x0d 和 \cM。</td>
</tr>
<tr>
<td align="left">\s</td>
<td align="left">匹配任何空白字符，包括空格、制表符、换页符等等。等价于 [ \f\n\r\t\v]。注意 Unicode 正则表达式会匹配全角空格符。</td>
</tr>
<tr>
<td align="left">\S</td>
<td align="left">匹配任何非空白字符。等价于 [^ \f\n\r\t\v]。</td>
</tr>
<tr>
<td align="left">\t</td>
<td align="left">匹配一个制表符。等价于 \x09 和 \cI。</td>
</tr>
<tr>
<td align="left">\v</td>
<td align="left">匹配一个垂直制表符。等价于 \x0b 和 \cK。</td>
</tr>
</tbody></table>
<hr>
<h2 id="特殊字符"><a href="#特殊字符" class="headerlink" title="特殊字符"></a>特殊字符</h2><p>所谓特殊字符，就是一些有特殊含义的字符，如上面说的 <strong>runoo*b</strong> 中的 <strong><strong>*，简单的说就是表示任何字符串的意思。如果要查找字符串中的 *</strong></strong> 符号，则需要对 <strong>*** 进行转义，即在其前加一个 **\</strong>: <strong>runo*ob</strong> 匹配 runo*ob。</p>
<p>许多元字符要求在试图匹配它们时特别对待。若要匹配这些特殊字符，必须首先使字符”转义”，即，将反斜杠字符<strong>\</strong> 放在它们前面。下表列出了正则表达式中的特殊字符：</p>
<table>
<thead>
<tr>
<th align="left">特别字符</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">$</td>
<td align="left">匹配输入字符串的结尾位置。如果设置了 RegExp 对象的 Multiline 属性，则 $ 也匹配 ‘\n’ 或 ‘\r’。要匹配 $ 字符本身，请使用 $。</td>
</tr>
<tr>
<td align="left">( )</td>
<td align="left">标记一个子表达式的开始和结束位置。子表达式可以获取供以后使用。要匹配这些字符，请使用 ( 和 )。</td>
</tr>
<tr>
<td align="left">*</td>
<td align="left">匹配前面的子表达式零次或多次。要匹配 * 字符，请使用 *。</td>
</tr>
<tr>
<td align="left">+</td>
<td align="left">匹配前面的子表达式一次或多次。要匹配 + 字符，请使用 +。</td>
</tr>
<tr>
<td align="left">.</td>
<td align="left">匹配除换行符 \n 之外的任何单字符。要匹配 . ，请使用 . 。</td>
</tr>
<tr>
<td align="left">[</td>
<td align="left">标记一个中括号表达式的开始。要匹配 [，请使用 [。</td>
</tr>
<tr>
<td align="left">?</td>
<td align="left">匹配前面的子表达式零次或一次，或指明一个非贪婪限定符。要匹配 ? 字符，请使用 ?。</td>
</tr>
<tr>
<td align="left">\</td>
<td align="left">将下一个字符标记为或特殊字符、或原义字符、或向后引用、或八进制转义符。例如， ‘n’ 匹配字符 ‘n’。’\n’ 匹配换行符。序列 ‘\‘ 匹配 “&quot;，而 ‘(‘ 则匹配 “(“。</td>
</tr>
<tr>
<td align="left">^</td>
<td align="left">匹配输入字符串的开始位置，除非在方括号表达式中使用，当该符号在方括号表达式中使用时，表示不接受该方括号表达式中的字符集合。要匹配 ^ 字符本身，请使用 ^。</td>
</tr>
<tr>
<td align="left">{</td>
<td align="left">标记限定符表达式的开始。要匹配 {，请使用 {。</td>
</tr>
<tr>
<td align="left">|</td>
<td align="left">指明两项之间的一个选择。要匹配 |，请使用 |。</td>
</tr>
</tbody></table>
<hr>
<h2 id="限定符"><a href="#限定符" class="headerlink" title="限定符"></a>限定符</h2><p>限定符用来指定正则表达式的一个给定组件必须要出现多少次才能满足匹配。有 <strong>*** 或 **+</strong> 或 <strong>?</strong> 或 <strong>{n}</strong> 或 <strong>{n,}</strong> 或 <strong>{n,m}</strong> 共6种。</p>
<p>正则表达式的限定符有：</p>
<table>
<thead>
<tr>
<th align="left">字符</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">*</td>
<td align="left">匹配前面的子表达式零次或多次。例如，zo* 能匹配 “z” 以及 “zoo”。* 等价于{0,}。</td>
</tr>
<tr>
<td align="left">+</td>
<td align="left">匹配前面的子表达式一次或多次。例如，’zo+’ 能匹配 “zo” 以及 “zoo”，但不能匹配 “z”。+ 等价于 {1,}。</td>
</tr>
<tr>
<td align="left">?</td>
<td align="left">匹配前面的子表达式零次或一次。例如，”do(es)?” 可以匹配 “do” 、 “does” 中的 “does” 、 “doxy” 中的 “do” 。? 等价于 {0,1}。</td>
</tr>
<tr>
<td align="left">{n}</td>
<td align="left">n 是一个非负整数。匹配确定的 n 次。例如，’o{2}’ 不能匹配 “Bob” 中的 ‘o’，但是能匹配 “food” 中的两个 o。</td>
</tr>
<tr>
<td align="left">{n,}</td>
<td align="left">n 是一个非负整数。至少匹配n 次。例如，’o{2,}’ 不能匹配 “Bob” 中的 ‘o’，但能匹配 “foooood” 中的所有 o。’o{1,}’ 等价于 ‘o+’。’o{0,}’ 则等价于 ‘o*’。</td>
</tr>
<tr>
<td align="left">{n,m}</td>
<td align="left">m 和 n 均为非负整数，其中n &lt;= m。最少匹配 n 次且最多匹配 m 次。例如，”o{1,3}” 将匹配 “fooooood” 中的前三个 o。’o{0,1}’ 等价于 ‘o?’。请注意在逗号和两个数之间不能有空格。</td>
</tr>
</tbody></table>
<p>以下正则表达式匹配一个正整数，<strong>[1-9]</strong>设置第一个数字不是 0，<strong>[0-9]*</strong> 表示任意多个数字：</p>
<h1 id="egrep"><a href="#egrep" class="headerlink" title="egrep"></a>egrep</h1><h2 id="grep和egrep正则表达式"><a href="#grep和egrep正则表达式" class="headerlink" title="grep和egrep正则表达式"></a>grep和egrep正则表达式</h2><p>Published on 2017-06-04 15:50 in 分类: <a href="https://www.cnblogs.com/python-gm/category/1013254.html" target="_blank" rel="noopener">Linux</a> with <a href="https://cnblogs.com/python-gm" target="_blank" rel="noopener">evescn</a></p>
<p><a href="https://www.cnblogs.com/python-gm/p/6940756.html" target="_blank" rel="noopener">https://www.cnblogs.com/python-gm/p/6940756.html</a></p>
<p>分类: <a href="https://www.cnblogs.com/python-gm/category/1013254.html" target="_blank" rel="noopener">Linux</a></p>
<p> Linux上文本处理三剑客</p>
<ul>
<li><p>grep ：文本过滤( 模式：pattern) 工具</p>
</li>
<li><p>grep, egrep, fgrep （不支持正则表达式搜索，但搜索纯文本的数据最快）</p>
</li>
<li><p>sed ：stream editor ，文本编辑工具</p>
</li>
<li><p>awk ：Linux上实际是gawk(GUN awk) ，文本报告生成器  </p>
<p>正则表达式：</p>
</li>
<li><p>由一类特殊字符及文本字符所编写的模式，其中有些字符（元字符）不表示字符字面意义，而表示控制或通配的功能</p>
</li>
<li><p>支持正则表达式的程序：grep, vim, less,nginx等 </p>
</li>
</ul>
<p> 正则表达式分两类：</p>
<ul>
<li>基本正则表达式：BRE </li>
</ul>
<pre class=" language-bash"><code class="language-bash"><span class="token function">grep</span><span class="token variable"><span class="token variable">`</span> <span class="token variable">`</span></span>,`<span class="token variable"><span class="token variable">`</span><span class="token function">egrep</span><span class="token variable">`</span></span> `-G 　　</code></pre>
<ul>
<li>扩展正则表达式：ERE </li>
</ul>
<pre class=" language-bash"><code class="language-bash"><span class="token function">grep</span><span class="token variable"><span class="token variable">`</span> <span class="token variable">`</span></span>-E, ``egrep</code></pre>
<pre><code>-E：使用ERE``　　　扩展的正则表达式　　</code></pre><p> 练习:</p>
<p>1、显示/etc/passwd 文件中不以/bin/bash 结尾的行</p>
<pre class=" language-bash"><code class="language-bash"><span class="token function">grep</span> -v <span class="token string">"/bin/bash$"</span> /etc/passwd</code></pre>
<p>2 、显示用户rpc 默认的shell 程序</p>
<pre class=" language-bash"><code class="language-bash"><span class="token function">grep</span> <span class="token string">"^rpc\>"</span> /etc/passwd <span class="token operator">|</span> <span class="token function">cut</span> -d: -f7</code></pre>
<p>3 、找出/etc/passwd 中的两位或三位数</p>
<pre class=" language-bash"><code class="language-bash"><span class="token function">grep</span> -E <span class="token string">"\&lt;[0-9]{2,3}\>"</span> /etc/passwd</code></pre>
<p>4 、找出”netstat -tan” 命令的结果中以’LISTEN’ 后跟0 、1或多个空白字符结尾的行</p>
<pre class=" language-bash"><code class="language-bash"><span class="token function">netstat</span> -tan <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"\&lt;LISTEN[[:space:]]*$"</span></code></pre>
<p> egrep及扩展的正则表达式</p>
<p>egrep = grep -E<br>egrep [OPTIONS] PATTERN [FILE…]<br>　　选项：</p>
<p>　　　　-i,-o,-v,q,-A,-B,-C<br>　　　　-G:支持基本的正则表达式</p>
<p> 扩展正则表达式元字符：</p>
<p> 练习：</p>
<p>1 、显示当前系统上，root,gao和user1用户的相关信息</p>
<pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># grep -E "\&lt;(root|gao|uer1)\>" /etc/passwd</span></code></pre>
<p>2 、统计以root 身份登录的每个远程主机IP</p>
<pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># who | grep -E "^root\>" | wc -l</span></code></pre>
<p>3 、使用egrep 取出/etc/rc.d/init.d/functions</p>
<pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># echo "/etc/rc.d/init.d/functions" | grep -oE "[^/]+/?$"</span></code></pre>
<h1 id="Sed"><a href="#Sed" class="headerlink" title="Sed"></a>Sed</h1><p>sed 是一种在线的非交互的编译器，它一次处理一行的内容。处理时，把当前处理的行储存在临时缓冲区中，称为模式空间，接着用sed命令处理缓冲区的内容，处理完成后，把缓冲区的内容送往屏幕。接着处理下一行，这样不断重复，直到文件末尾。文件内容并没有改变，除非你使用重定向储存输出。<br> sed主要用来自动编辑一个或多个文件；简化对文件的反复操作；编写转换程序等。</p>
<h2 id="用法-sed-命令-＋目录-文件1-目录-文件2"><a href="#用法-sed-命令-＋目录-文件1-目录-文件2" class="headerlink" title="用法 sed + 命令  ＋目录/文件1  目录/文件2"></a>用法 sed + 命令  ＋目录/文件1  目录/文件2</h2><h2 id="sed支持正则表达式"><a href="#sed支持正则表达式" class="headerlink" title="sed支持正则表达式"></a>sed支持正则表达式</h2><p>使用基本元字符集 ^, $, ., *, [], [^], &lt; &gt;,(),{}<br> 使用扩展元字符集 ?, +, { }, |, ( )使用扩展元字符的方式：<br> sed -r</p>
<h2 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">sed</span> -r <span class="token string">' '</span>      mypasswd
<span class="token function">sed</span> -r <span class="token string">' p '</span>   mypasswd</code></pre>
<p>屏蔽默认输出使用 -n选项</p>
<pre class=" language-bash"><code class="language-bash"><span class="token function">sed</span> -rn <span class="token string">' p '</span>   mypasswd
<span class="token function">sed</span> -rn  <span class="token string">' /root/p '</span>  mypasswd  显示root的行    ^匹配root开头   ^root</code></pre>
<h2 id="探索替换-（重要）"><a href="#探索替换-（重要）" class="headerlink" title="探索替换*（重要）"></a>探索替换*（重要）</h2><p>sed会自动打印文件的每一行， 查找模式匹配的行，找到后执行后面的命令，默认是输出（不加-n）</p>
<pre class=" language-bash"><code class="language-bash"><span class="token function">sed</span> -r <span class="token string">' s/root/shark/ '</span>  mypasswd
搜索每一行，找到有root的，只替换第一个
<span class="token function">sed</span> -r <span class="token string">' s/root/shark/g '</span>  mypasswd
搜索每一行，找到有root的进行全局替换
<span class="token function">sed</span> -r <span class="token string">' s/root/shark/gi '</span>   mypasswd
i  同时忽略大小写
<span class="token function">sed</span> -r <span class="token string">'  /root/d '</span> mypasswd
找到含有root的进行删除</code></pre>
<h2 id="删除命令拓展"><a href="#删除命令拓展" class="headerlink" title="删除命令拓展"></a>删除命令拓展</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">sed</span> -r <span class="token string">'d'</span>  mypasswd
全部分删除
<span class="token function">sed</span> -r  <span class="token string">' 3   d '</span>
删除第三行
<span class="token function">sed</span> -r  <span class="token string">' 1,3 d '</span> 
第一行到第三行都删除
<span class="token function">sed</span> -r <span class="token string">' /root/ d '</span>
含有root的字符串删除
<span class="token function">sed</span> -r <span class="token string">' /root/,5 d '</span>
从含有root字符串的行开始，一直到第5行进行删除
<span class="token function">sed</span> -r <span class="token string">' /^adm/，20 d '</span>
从行首是adm 的行开始，一直到20行进行删除
<span class="token function">sed</span> -r <span class="token string">' /^adm/ ,+2 d '</span> 
从行首是adm的行，以及此后两行的进行删除
<span class="token function">sed</span> -r <span class="token string">' /root/ !d '</span>
含有root的行不删除，其他都删除
<span class="token function">sed</span> -r <span class="token string">' 1~2 d '</span>
奇数行删除，其实就是匹配到行号除以2，余数是1的行
<span class="token function">sed</span> -rn <span class="token string">' 0~2  p '</span>
偶数行打印</code></pre>
<h2 id="sed参数大全"><a href="#sed参数大全" class="headerlink" title="sed参数大全"></a>sed参数大全</h2><p>a 在当前行后添加一行或多行<br> c 用新文本修改（替换）当前行中的文本<br> d 删除行<br> i 在当前行之前插入文本<br> l 列出非打印字符<br> p 打印行<br> n 读入下一输入行，并从下一条命令而不是第一条命令开始对其的处理<br> q 结束或退出sed<br> ! 对所选行以外的所有行应用命令</p>
<p>s 用一个字符串替换另一个<br> s 替换标志<br> g 全局替换<br> i 忽略大小写<br> r 从文件中读<br> w 将行写入文件<br> y 将字符转换为另一字符（不支持正则表达式）</p>
<p>h  清除保持空间的内容后，把模式空间里的内容复制到保持空间<br> H  把模式空间里的内容追加到保持空间<br> g  清除模式空间的内容后， 取出保持空间的内容，并复制到模式空间<br> G  取出保持空间的内容，追加在模式空间原有内容的后面<br> x  交换模式空间与保持空间的内容</p>
<h1 id="Linux-sed-命令"><a href="#Linux-sed-命令" class="headerlink" title="Linux sed 命令"></a>Linux sed 命令</h1><p><a href="https://www.runoob.com/linux/linux-command-manual.html" target="_blank" rel="noopener"><img src="https://www.runoob.com/images/up.gif" alt="Linux 命令大全"> Linux 命令大全</a></p>
<p>Linux sed 命令是利用脚本来处理文本文件。</p>
<p>sed 可依照脚本的指令来处理、编辑文本文件。</p>
<p>Sed 主要用来自动编辑一个或多个文件、简化对文件的反复操作、编写转换程序等。</p>
<h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><pre class=" language-bash"><code class="language-bash"><span class="token function">sed</span> <span class="token punctuation">[</span>-hnV<span class="token punctuation">]</span><span class="token punctuation">[</span>-e<span class="token operator">&lt;</span>script<span class="token operator">></span><span class="token punctuation">]</span><span class="token punctuation">[</span>-f<span class="token operator">&lt;</span>script文件<span class="token operator">></span><span class="token punctuation">]</span><span class="token punctuation">[</span>文本文件<span class="token punctuation">]</span></code></pre>
<h2 id="参数说明："><a href="#参数说明：" class="headerlink" title="参数说明："></a><strong>参数说明</strong>：</h2><ul>
<li>-e<script>或--expression=<script> 以选项中指定的script来处理输入的文本文件。</li>
<li>-f<script文件>或--file=<script文件> 以选项中指定的script文件来处理输入的文本文件。</li>
<li>-h或--help 显示帮助。</li>
<li>-n或--quiet或--silent 仅显示script处理后的结果。</li>
<li>-V或--version 显示版本信息。</li>
</ul>
<h2 id="动作说明："><a href="#动作说明：" class="headerlink" title="动作说明："></a><strong>动作说明</strong>：</h2><ul>
<li>a ：新增， a 的后面可以接字串，而这些字串会在新的一行出现(目前的下一行)～</li>
<li>c ：取代， c 的后面可以接字串，这些字串可以取代 n1,n2 之间的行！</li>
<li>d ：删除，因为是删除啊，所以 d 后面通常不接任何咚咚；</li>
<li>i ：插入， i 的后面可以接字串，而这些字串会在新的一行出现(目前的上一行)；</li>
<li>p ：打印，亦即将某个选择的数据印出。通常 p 会与参数 sed -n 一起运行～</li>
<li>s ：取代，可以直接进行取代的工作哩！通常这个 s 的动作可以搭配正规表示法！例如 1,20s/old/new/g 就是啦！</li>
</ul>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><p>在testfile文件的第四行后添加一行，并将结果输出到标准输出，在命令行提示符下输入如下命令：</p>
<pre class=" language-bash"><code class="language-bash"><span class="token function">sed</span> -e 4a\newLine testfile </code></pre>
<p>首先查看testfile中的内容如下：</p>
<pre class=" language-bash"><code class="language-bash">$ <span class="token function">cat</span> testfile <span class="token comment" spellcheck="true">#查看testfile 中的内容  </span>
HELLO LINUX<span class="token operator">!</span>  
Linux is a <span class="token function">free</span> unix-type opterating system.  
This is a linux testfile<span class="token operator">!</span>  
Linux <span class="token function">test</span> </code></pre>
<p>使用sed命令后，输出结果如下：</p>
<pre class=" language-bash"><code class="language-bash">$ <span class="token function">sed</span> -e 4a\newline testfile <span class="token comment" spellcheck="true">#使用sed 在第四行后添加新字符串  </span>
HELLO LINUX<span class="token operator">!</span> <span class="token comment" spellcheck="true">#testfile文件原有的内容  </span>
Linux is a <span class="token function">free</span> unix-type opterating system.  
This is a linux testfile<span class="token operator">!</span>  
Linux <span class="token function">test</span>  
newline </code></pre>
<h3 id="以行为单位的新增-删除"><a href="#以行为单位的新增-删除" class="headerlink" title="以行为单位的新增/删除"></a>以行为单位的新增/删除</h3><p>将 /etc/passwd 的内容列出并且列印行号，同时，请将第 2~5 行删除！</p>
<pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@www ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># nl /etc/passwd | sed '2,5d'</span>
1 root:x:0:0:root:/root:/bin/bash
6 sync:x:5:0:sync:/sbin:/bin/sync
7 shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
<span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">(</span>后面省略<span class="token punctuation">)</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.</code></pre>
<p>sed 的动作为 '2,5d' ，那个 d 就是删除！因为 2-5 行给他删除了，所以显示的数据就没有 2-5 行罗～ 另外，注意一下，原本应该是要下达 sed -e 才对，没有 -e 也行啦！同时也要注意的是， sed 后面接的动作，请务必以 '' 两个单引号括住喔！</p>
<p>只要删除第 2 行</p>
<pre class=" language-bash"><code class="language-bash"><span class="token function">nl</span> /etc/passwd <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'2d'</span> </code></pre>
<p>要删除第 3 到最后一行</p>
<pre class=" language-bash"><code class="language-bash"><span class="token function">nl</span> /etc/passwd <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'3,<span class="token variable">$d</span>'</span> </code></pre>
<p>在第二行后(亦即是加在第三行)加上『drink tea?』字样！</p>
<pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@www ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># nl /etc/passwd | sed '2a drink tea'</span>
1 root:x:0:0:root:/root:/bin/bash
2 bin:x:1:1:bin:/bin:/sbin/nologin
drink tea
3 daemon:x:2:2:daemon:/sbin:/sbin/nologin
<span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">(</span>后面省略<span class="token punctuation">)</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.</code></pre>
<p>那如果是要在第二行前</p>
<pre class=" language-bash"><code class="language-bash"><span class="token function">nl</span> /etc/passwd <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'2i drink tea'</span> </code></pre>
<p>如果是要增加两行以上，在第二行后面加入两行字，例如 <strong>Drink tea or .....</strong> 与 <strong>drink beer?</strong></p>
<pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@www ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># nl /etc/passwd | sed '2a Drink tea or ......\</span>
<span class="token operator">></span> drink beer ?'
1 root:x:0:0:root:/root:/bin/bash
2 bin:x:1:1:bin:/bin:/sbin/nologin
Drink tea or <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
drink beer ?
3 daemon:x:2:2:daemon:/sbin:/sbin/nologin
<span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">(</span>后面省略<span class="token punctuation">)</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.</code></pre>
<p>每一行之间都必须要以反斜杠『 \ 』来进行新行的添加喔！所以，上面的例子中，我们可以发现在第一行的最后面就有 \ 存在。</p>
<h3 id="以行为单位的替换与显示"><a href="#以行为单位的替换与显示" class="headerlink" title="以行为单位的替换与显示"></a>以行为单位的替换与显示</h3><p>将第2-5行的内容取代成为『No 2-5 number』呢？</p>
<pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@www ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># nl /etc/passwd | sed '2,5c No 2-5 number'</span>
1 root:x:0:0:root:/root:/bin/bash
No 2-5 number
6 sync:x:5:0:sync:/sbin:/bin/sync
<span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">(</span>后面省略<span class="token punctuation">)</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.</code></pre>
<p>透过这个方法我们就能够将数据整行取代了！</p>
<p>仅列出 /etc/passwd 文件内的第 5-7 行</p>
<pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@www ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># nl /etc/passwd | sed -n '5,7p'</span>
5 lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
6 sync:x:5:0:sync:/sbin:/bin/sync
7 shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</code></pre>
<p>可以透过这个 sed 的以行为单位的显示功能， 就能够将某一个文件内的某些行号选择出来显示。</p>
<h3 id="数据的搜寻并显示"><a href="#数据的搜寻并显示" class="headerlink" title="数据的搜寻并显示"></a>数据的搜寻并显示</h3><p>搜索 /etc/passwd有root关键字的行</p>
<pre class=" language-bash"><code class="language-bash"><span class="token function">nl</span> /etc/passwd <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'/root/p'</span>
1  root:x:0:0:root:/root:/bin/bash
1  root:x:0:0:root:/root:/bin/bash
2  daemon:x:1:1:daemon:/usr/sbin:/bin/sh
3  bin:x:2:2:bin:/bin:/bin/sh
4  sys:x:3:3:sys:/dev:/bin/sh
5  sync:x:4:65534:sync:/bin:/bin/sync
<span class="token punctuation">..</span><span class="token punctuation">..</span>下面忽略 </code></pre>
<p>如果root找到，除了输出所有行，还会输出匹配行。</p>
<p>使用-n的时候将只打印包含模板的行。</p>
<pre class=" language-bash"><code class="language-bash"><span class="token function">nl</span> /etc/passwd <span class="token operator">|</span> <span class="token function">sed</span> -n <span class="token string">'/root/p'</span>
1  root:x:0:0:root:/root:/bin/bash</code></pre>
<h3 id="数据的搜寻并删除"><a href="#数据的搜寻并删除" class="headerlink" title="数据的搜寻并删除"></a>数据的搜寻并删除</h3><p>删除/etc/passwd所有包含root的行，其他行输出</p>
<pre class=" language-bash"><code class="language-bash"><span class="token function">nl</span> /etc/passwd <span class="token operator">|</span> <span class="token function">sed</span>  <span class="token string">'/root/d'</span>
2  daemon:x:1:1:daemon:/usr/sbin:/bin/sh
3  bin:x:2:2:bin:/bin:/bin/sh
<span class="token punctuation">..</span><span class="token punctuation">..</span>下面忽略
<span class="token comment" spellcheck="true">#第一行的匹配root已经删除了</span></code></pre>
<h3 id="数据的搜寻并执行命令"><a href="#数据的搜寻并执行命令" class="headerlink" title="数据的搜寻并执行命令"></a>数据的搜寻并执行命令</h3><p>搜索/etc/passwd,找到root对应的行，执行后面花括号中的一组命令，每个命令之间用分号分隔，这里把bash替换为blueshell，再输出这行：</p>
<pre class=" language-bash"><code class="language-bash"><span class="token function">nl</span> /etc/passwd <span class="token operator">|</span> <span class="token function">sed</span> -n <span class="token string">'/root/{s/bash/blueshell/;p;q}'</span>    
1  root:x:0:0:root:/root:/bin/blueshell</code></pre>
<p>最后的q是退出。</p>
<h3 id="数据的搜寻并替换"><a href="#数据的搜寻并替换" class="headerlink" title="数据的搜寻并替换"></a>数据的搜寻并替换</h3><p>除了整行的处理模式之外， sed 还可以用行为单位进行部分数据的搜寻并取代。基本上 sed 的搜寻与替代的与 vi 相当的类似！他有点像这样：</p>
<pre class=" language-bash"><code class="language-bash"><span class="token function">sed</span> <span class="token string">'s/要被取代的字串/新的字串/g'</span></code></pre>
<p>先观察原始信息，利用 /sbin/ifconfig 查询 IP</p>
<pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@www ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># /sbin/ifconfig eth0</span>
eth0 Link encap:Ethernet HWaddr 00:90:CC:A6:34:84
inet addr:192.168.1.100 Bcast:192.168.1.255 Mask:255.255.255.0
inet6 addr: fe80::290:ccff:fea6:3484/64 Scope:Link
UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1
<span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">(</span>以下省略<span class="token punctuation">)</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.</code></pre>
<p>本机的ip是192.168.1.100。</p>
<p>将 IP 前面的部分予以删除</p>
<pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@www ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># /sbin/ifconfig eth0 | grep 'inet addr' | sed 's/^.*addr://g'</span>
192.168.1.100 Bcast:192.168.1.255 Mask:255.255.255.0</code></pre>
<p>接下来则是删除后续的部分，亦即： 192.168.1.100 Bcast:192.168.1.255 Mask:255.255.255.0</p>
<p>将 IP 后面的部分予以删除</p>
<pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@www ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># /sbin/ifconfig eth0 | grep 'inet addr' | sed 's/^.*addr://g' | sed 's/Bcast.*$//g'</span>
192.168.1.100</code></pre>
<h3 id="多点编辑"><a href="#多点编辑" class="headerlink" title="多点编辑"></a>多点编辑</h3><p>一条sed命令，删除/etc/passwd第三行到末尾的数据，并把bash替换为blueshell</p>
<pre class=" language-bash"><code class="language-bash"><span class="token function">nl</span> /etc/passwd <span class="token operator">|</span> <span class="token function">sed</span> -e <span class="token string">'3,<span class="token variable">$d</span>'</span> -e <span class="token string">'s/bash/blueshell/'</span>
1  root:x:0:0:root:/root:/bin/blueshell
2  daemon:x:1:1:daemon:/usr/sbin:/bin/sh</code></pre>
<p>-e表示多点编辑，第一个编辑命令删除/etc/passwd第三行到末尾的数据，第二条命令搜索bash替换为blueshell。</p>
<h3 id="直接修改文件内容-危险动作"><a href="#直接修改文件内容-危险动作" class="headerlink" title="直接修改文件内容(危险动作)"></a>直接修改文件内容(危险动作)</h3><p>sed 可以直接修改文件的内容，不必使用管道命令或数据流重导向！ 不过，由於这个动作会直接修改到原始的文件，所以请你千万不要随便拿系统配置来测试！ 我们还是使用文件 regular_express.txt 文件来测试看看吧！</p>
<p>regular_express.txt 文件内容如下：</p>
<pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@www ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># cat regular_express.txt </span>
runoob.
google.
taobao.
facebook.
zhihu-
weibo-</code></pre>
<p>利用 sed 将 regular_express.txt 内每一行结尾若为 . 则换成 !</p>
<pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@www ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># sed -i 's/\.$/\!/g' regular_express.txt</span>
<span class="token punctuation">[</span>root@www ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># cat regular_express.txt </span>
runoob<span class="token operator">!</span>
google<span class="token operator">!</span>
taobao<span class="token operator">!</span>
facebook<span class="token operator">!</span>
zhihu-
weibo-</code></pre>
<p>:q:q</p>
<p>利用 sed 直接在 regular_express.txt 最后一行加入 <strong># This is a test</strong>:</p>
<pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@www ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># sed -i '$a # This is a test' regular_express.txt</span>
<span class="token punctuation">[</span>root@www ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># cat regular_express.txt </span>
runoob<span class="token operator">!</span>
google<span class="token operator">!</span>
taobao<span class="token operator">!</span>
facebook<span class="token operator">!</span>
zhihu-
weibo-
<span class="token comment" spellcheck="true"># This is a test</span></code></pre>
<p>由於 $ 代表的是最后一行，而 a 的动作是新增，因此该文件最后新增 <strong># This is a test</strong>！</p>
<p>sed 的 <strong>-i</strong> 选项可以直接修改文件内容，这功能非常有帮助！举例来说，如果你有一个 100 万行的文件，你要在第 100 行加某些文字，此时使用 vim 可能会疯掉！因为文件太大了！那怎办？就利用 sed 啊！透过 sed 直接修改/取代的功能，你甚至不需要使用 vim 去修订！</p>
<h1 id="AWK"><a href="#AWK" class="headerlink" title="AWK"></a>AWK</h1><h2 id="选项参数说明："><a href="#选项参数说明：" class="headerlink" title="选项参数说明："></a>选项参数说明：</h2><pre class=" language-shell"><code class="language-shell">-F fs or --field-separator fs
指定输入文件折分隔符，fs是一个字符串或者是一个正则表达式，如-F:。
-v var=value or --asign var=value
赋值一个用户定义变量。
-f scripfile or --file scriptfile
从脚本文件中读取awk命令。
-mf nnn and -mr nnn
对nnn值设置内在限制，-mf选项限制分配给nnn的最大块数目；-mr选项限制记录的最大数目。这两个功能是Bell实验室版awk的扩展功能，在标准awk中不适用。
-W compact or --compat, -W traditional or --traditional
在兼容模式下运行awk。所以gawk的行为和标准的awk完全一样，所有的awk扩展都被忽略。
-W copyleft or --copyleft, -W copyright or --copyright
打印简短的版权信息。
-W help or --help, -W usage or --usage
打印全部awk选项和每个选项的简短说明。
-W lint or --lint
打印不能向传统unix平台移植的结构的警告。
-W lint-old or --lint-old
打印关于不能向传统unix平台移植的结构的警告。
-W posix
打开兼容模式。但有以下限制，不识别：/x、函数关键字、func、换码序列以及当fs是一个空格时，将新行作为一个域分隔符；操作符**和**=不能代替^和^=；fflush无效。
-W re-interval or --re-inerval
允许间隔正则表达式的使用，参考(grep中的Posix字符类)，如括号表达式[[:alpha:]]。
-W source program-text or --source program-text
使用program-text作为源代码，可与-f命令混用。
-W version or --version
打印bug报告信息的版本</code></pre>
<pre class=" language-shell"><code class="language-shell">awk -F':' '{print $1}' /etc/passwd

awk  'BEGIN{FS=":";OFS="---"} {print $1,$2} END{print 123}' /etc/passwd

awk  'BEGIN{FS=":";OFS="---"} {print $1,$2}' /etc/passwd

df | grep '/' | awk '$4>1000000 {print $4}'

$0 文件本身
NR 所有文件显示行号
FNR 显示对于当前文件的行号
NF 保存记录字段数
FS 默认分隔符
OFS 把,映射为的值
RS 记录分隔符
ORS 输入的分隔符

awk -F[ \t:] 后面可以加正则的 -F后面

ps -ef | awk '$1~/^root/'  匹配第一列是root开头的行
用正则的时候,,,前后加/
</code></pre>
<h2 id="printf"><a href="#printf" class="headerlink" title="printf"></a>printf</h2><pre class=" language-shell"><code class="language-shell">awk  'BEGIN{FS=":"} {printf "%-15s %-15s %-15s\n", $1,$2,$3}' /etc/passwd
输出占位格式
</code></pre>
<h2 id="条件表达式"><a href="#条件表达式" class="headerlink" title="条件表达式"></a>条件表达式</h2><pre class=" language-shell"><code class="language-shell">df | grep "/"  | awk '{ if($4>=10000000){print $0} else {print "2333"}}'
2333
2333
2333
2333
/dev/vda1       41152812 5875668  33373436  15% /
overlay         41152812 5875668  33373436  15% /var/lib/docker/overlay2/bbf1e03279cfbbf5c0af2814c5c05ace215eb61b94cf25db0e6fb81a5cf2722c/merged
2333
2333</code></pre>
<h2 id="算数运算"><a href="#算数运算" class="headerlink" title="算数运算"></a>算数运算</h2><pre class=" language-shell"><code class="language-shell">df | grep "/"  | awk '{if($4>100000){print $4":"$4*9}}'
1929672:17367048
1939748:17457732
1939388:17454492
1940064:17460576
33373420:300360780
33373420:300360780
388016:3492144
</code></pre>
<h2 id="逻辑运算"><a href="#逻辑运算" class="headerlink" title="逻辑运算"></a>逻辑运算</h2><pre class=" language-shell"><code class="language-shell">df | grep "/"| awk '$1~/^tmp/ && $4>=100000{print $4}' 
或者
df | grep "/"| awk '{if($1~/^tmp/ &&  $4>=100000){print $4}}'
1939744
1939388
1940064
388016
df | grep "/"| awk '$1~/^tmp/ || $4>=100000{print $4}' 
1929672
1939744
1939388
1940064
33373412
33373412
388016
df | grep "/"| awk '!($1~/^tmp/ &&  $4>=100000){print $4}' 
1929672
33373412
33373412
65536
</code></pre>
<h2 id="AWK-的-if-else-do-while"><a href="#AWK-的-if-else-do-while" class="headerlink" title="AWK 的 if else do while"></a>AWK 的 if else do while</h2><pre class=" language-shell"><code class="language-shell">df | grep "/"| awk '{if($1~/^tmp/ &&  $4>=100000){print $4}}'

df | grep "/"| awk '{if($1~/^tmp/){++i}}END{print "开头是tmp的有:"i"个"}' 
开头是tmp的有:4个

awk '{i=1;while(i<=NF){print $i;i++}}' t.txt
111
222
333
444
555
666
777
888
awk '{for(i=1;i<=NF;i++){print $i}}' t.txt
111
222
333
444
555
666
777
888
</code></pre>
<h2 id="awk的数组"><a href="#awk的数组" class="headerlink" title="awk的数组"></a>awk的数组</h2><pre class=" language-shell"><code class="language-shell">awk -F":"  '{username[x++]=$1} END{for(i =0;i<x;i++){print username[i]}}'  /etc/passwd
root
bin
daemon
adm
lp
sync
shutdown
halt
mail
operator
games
ftp
nobody
systemd-network
dbus
polkitd
sshd
postfix
chrony
nscd
tcpdump
tss
dockerroot
ntp
www
mysql
lhq
saslauth
mailnull
smmsp

awk -F":"  '{username[x++]=$1} END{for(i in username){print i,username[i]}}'  /etc/passwd
26 lhq
17 postfix
4 lp
27 saslauth
18 chrony
5 sync
28 mailnull
19 nscd
6 shutdown
29 smmsp
7 halt
8 mail
9 operator
10 games
20 tcpdump
11 ftp
21 tss
12 nobody
22 dockerroot
13 systemd-network
0 root
23 ntp
14 dbus
1 bin
24 www
15 polkitd
2 daemon
25 mysql
16 sshd
3 adm

awk -F":" '{shells[$NF]++} END{for(key in shells){print key, shells[key]}}' /etc/passwd 
/bin/bash 1
/bin/sync 1
/sbin/nologin 25
/sbin/halt 1
/bin/zsh 1
/sbin/shutdown 1


netstat -ant | grep ':80' | awk '{status[$NF]++} END{for(i in status){print i,status[i]}}' 
LISTEN 1
ESTABLISHED 1


ss -ant | grep ":80" | awk '{status[$1]++} END{for(i in status) {print i, status[i]}}' 
LISTEN 1
ESTAB 1

ss -an | grep ':80' | awk '{if(length($2)==6){cout++}}END{print cout}' 
4
</code></pre>
<h2 id="AWK-使用外部变量"><a href="#AWK-使用外部变量" class="headerlink" title="AWK 使用外部变量"></a>AWK 使用外部变量</h2><pre class=" language-shell"><code class="language-shell">方法一: 双引号,内部双引号用\转义
{14:18}~ ➭ var=bash ;echo "123 456" | awk "gsub(/123/,\"$var\")"
bash 456

方法二:  用双引号把单引号括起来
var=bash ;echo "123 shell" | awk 'gsub(/123/,"'"$var"'")'
bash shell
方法三:用-v 参数
echo "123 shell" | awk -v var="bash" 'gsub(/123/,var)'
bash shell</code></pre>
<pre class=" language-bash"><code class="language-bash"><span class="token function">ls</span> -1 <span class="token operator">|</span> <span class="token function">head</span> -n 2  <span class="token operator">>></span> 查看前两个文件

<span class="token function">ls</span> -1 --sort<span class="token operator">=</span>size -r  <span class="token operator">>></span> 当前目录的文件按照从大到小排序</code></pre>
<pre class=" language-bash"><code class="language-bash"><span class="token function">awk</span> -F, <span class="token string">'{print <span class="token variable">$1</span>,<span class="token variable">$2</span>}'</span>   log.txt</code></pre>
</script></li></ul>
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://liuhuaqiang.top" rel="external nofollow noreferrer">anlen123</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://liuhuaqiang.top/2020/10/21/shell-xue-xi/">https://liuhuaqiang.top/2020/10/21/shell-xue-xi/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="https://liuhuaqiang.top" target="_blank">anlen123</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/linux/">
                                    <span class="chip bg-color">linux</span>
                                </a>
                            
                                <a href="/tags/shell/">
                                    <span class="chip bg-color">shell</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2020/10/22/ffmpeg/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/7.jpg" class="responsive-img" alt="ffmpeg">
                        
                        <span class="card-title">ffmpeg</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            ffmpeg按时间切割视频ffmpeg -i in.mp4 -c copy -ss 开始时间 -t 持续时间 out.mp4
ps : 
ffmpeg -i inputfile.mp4 -c copy -ss00:05:00 -t 00:2
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2020-10-22
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            anlen123
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/linux/">
                        <span class="chip bg-color">linux</span>
                    </a>
                    
                    <a href="/tags/ffmpeg/">
                        <span class="chip bg-color">ffmpeg</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2020/10/12/elasticsearch-xue-xi/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/1.jpg" class="responsive-img" alt="elasticsearch学习">
                        
                        <span class="card-title">elasticsearch学习</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            Elasticsearch准备工作全文索引引擎
安装Elacsearch下载: https://www.elastic.co/cn/downloads/elasticsearch
端口9200

安装head可视化可视化: https://
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2020-10-12
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            anlen123
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/java/">
                        <span class="chip bg-color">java</span>
                    </a>
                    
                    <a href="/tags/spring/">
                        <span class="chip bg-color">spring</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


<!-- 代码块折行 -->

<style type="text/css">
code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
</style>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    
    <div class="container row center-align" style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            <span id="year">2019</span>
            <a href="https://liuhuaqiang.top" target="_blank">anlen123</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/anlen123" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:1761512493@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1761512493" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1761512493" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/search.xml", 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
